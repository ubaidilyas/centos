{"AllocModifyIndex":33412
"AllocatedResources":{"Shared":{"DiskMB":300
"Networks":null}
"Tasks":{"filebeat":{"Cpu":{"CpuShares":100}
"Devices":null
"Memory":{"MemoryMB":300}
"Networks":null}
"redis":{"Cpu":{"CpuShares":100}
"Devices":null
"Memory":{"MemoryMB":300}
"Networks":[{"CIDR":""
"Device":"eth0"
"DynamicPorts":[{"Label":"redis"
"To":0
"Value":20055}]
"IP":"172.21.39.7"
"MBits":10
"Mode":""
"ReservedPorts":null}]}
"mm-api-content-curator":{"Cpu":{"CpuShares":500}
"Devices":null
"Memory":{"MemoryMB":256}
"Networks":[{"CIDR":""
"Device":"eth0"
"DynamicPorts":[{"Label":"api"
"To":0
"Value":31334}
{"Label":"admin"
"To":0
"Value":29991}]
"IP":"172.21.39.7"
"MBits":1
"Mode":""
"ReservedPorts":null}]}}}
"ClientDescription":"Tasks are running"
"ClientStatus":"running"
"CreateIndex":33412
"CreateTime":1584440530161000905
"DeploymentID":"b10da41c-0a19-e973-5171-03e997e648e2"
"DeploymentStatus":{"Canary":false
"Healthy":true
"ModifyIndex":33428
"Timestamp":"2020-03-17T10:24:22.970516953Z"}
"DesiredStatus":"run"
"EvalID":"2746ca8c-fe05-3a4f-6957-6ad9e98eea01"
"ID":"035e43d2-239a-168c-f59d-bb8a78b9c48f"
"Job":{"Affinities":null
"AllAtOnce":false
"Constraints":[{"LTarget":"${meta.zone}"
"Operand":"distinct_property"
"RTarget":"1"}]
"CreateIndex":25732
"Datacenters":["azwe"]
"Dispatched":false
"ID":"mm-api-content-curator"
"JobModifyIndex":33410
"Meta":null
"ModifyIndex":33410
"Name":"mm-api-content-curator"
"Namespace":"default"
"ParameterizedJob":null
"ParentID":""
"Payload":null
"Periodic":null
"Priority":50
"Region":"global"
"Spreads":null
"Stable":false
"Status":"running"
"StatusDescription":""
"Stop":false
"SubmitTime":1584440529775628638
"TaskGroups":[{"Affinities":null
"Constraints":[{"LTarget":"${attr.os.signals}"
"Operand":"set_contains"
"RTarget":"SIGHUP"}]
"Count":2
"EphemeralDisk":{"Migrate":false
"SizeMB":300
"Sticky":false}
"Meta":null
"Migrate":{"HealthCheck":"checks"
"HealthyDeadline":300000000000
"MaxParallel":1
"MinHealthyTime":10000000000}
"Name":"mm-api-content-curator"
"Networks":null
"ReschedulePolicy":{"Attempts":0
"Delay":30000000000
"DelayFunction":"exponential"
"Interval":0
"MaxDelay":3600000000000
"Unlimited":true}
"RestartPolicy":{"Attempts":3
"Delay":15000000000
"Interval":1800000000000
"Mode":"fail"}
"Services":null
"Spreads":null
"Tasks":[{"Affinities":null
"Artifacts":null
"Config":{"volumes":["local/filebeat.yml:/usr/share/filebeat/filebeat.yml"]
"image":"elastic/filebeat:7.4.2"}
"Constraints":null
"DispatchPayload":null
"Driver":"docker"
"Env":null
"KillSignal":""
"KillTimeout":5000000000
"Kind":""
"Leader":false
"LogConfig":{"MaxFileSizeMB":10
"MaxFiles":10}
"Meta":null
"Name":"filebeat"
"Resources":{"CPU":100
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":300
"Networks":null}
"Services":null
"ShutdownDelay":0
"Templates":[{"ChangeMode":"restart"
"ChangeSignal":""
"DestPath":"local/filebeat.yml"
"EmbeddedTmpl":"filebeat.inputs:\n- type: log\n  paths:\n    - /alloc/logs/*.log\n    - /alloc/logs/*.0\n    - /alloc/logs/**/*.log\n  fields_under_root: true\n  fields:\n    application: mm-api-content-curator\n    environment: stage\noutput.kafka:\n  enabled: true\n  # initial brokers for reading cluster metadata\n  hosts: [\"172.21.35.206:9092\"]\n  topic: \"logs\"\n  required_acks: 1\t\n"
"Envvars":false
"LeftDelim":"{{"
"Perms":"0644"
"RightDelim":"}}"
"SourcePath":""
"Splay":5000000000
"VaultGrace":15000000000}]
"User":""
"Vault":null
"VolumeMounts":null}
{"Affinities":null
"Artifacts":null
"Config":{"image":"redis:latest"
"port_map":[{"redis":6379.0}]}
"Constraints":null
"DispatchPayload":null
"Driver":"docker"
"Env":null
"KillSignal":""
"KillTimeout":5000000000
"Kind":""
"Leader":false
"LogConfig":{"MaxFileSizeMB":10
"MaxFiles":10}
"Meta":null
"Name":"redis"
"Resources":{"CPU":100
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":300
"Networks":[{"CIDR":""
"Device":""
"DynamicPorts":[{"Label":"redis"
"To":0
"Value":0}]
"IP":""
"MBits":10
"Mode":""
"ReservedPorts":null}]}
"Services":[{"AddressMode":"auto"
"CanaryTags":null
"Checks":[{"AddressMode":""
"Args":null
"CheckRestart":null
"Command":""
"GRPCService":""
"GRPCUseTLS":false
"Header":null
"InitialStatus":""
"Interval":20000000000
"Method":""
"Name":"alive"
"Path":""
"PortLabel":""
"Protocol":""
"TLSSkipVerify":false
"TaskName":""
"Timeout":3000000000
"Type":"tcp"}]
"Connect":null
"Meta":null
"Name":"${NOMAD_GROUP_NAME}-redis"
"PortLabel":"redis"
"Tags":["redis"
"db"]}]
"ShutdownDelay":0
"Templates":null
"User":""
"Vault":null
"VolumeMounts":null}
{"Affinities":null
"Artifacts":[{"GetterMode":"file"
"GetterOptions":null
"GetterSource":"http://int.config-service.stg.arvm.de/mm-api-content-curator-stg.yml"
"RelativeDest":"local/env.yaml.tmpl"}]
"Config":{"port_map":[{"admin":8002.0
"api":8001.0}]
"volumes":["local/env.yaml:/etc/env.yaml"]
"auth":[{"username":"mondia"
"password":"rOIo1ss1AIuyjdnx+ZYStPuQ1mzsJkA5"}]
"image":"mondia.azurecr.io/mondia/mm-api-content-curator:3f7decb7c85"}
"Constraints":null
"DispatchPayload":null
"Driver":"docker"
"Env":{"DEBUG":"*"
"LOG_PATH":"/alloc/logs"
"NODE_SYSCONFIG":"/etc/env.yaml"}
"KillSignal":""
"KillTimeout":5000000000
"Kind":""
"Leader":true
"LogConfig":{"MaxFileSizeMB":10
"MaxFiles":10}
"Meta":null
"Name":"mm-api-content-curator"
"Resources":{"CPU":500
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":256
"Networks":[{"CIDR":""
"Device":""
"DynamicPorts":[{"Label":"api"
"To":0
"Value":0}
{"Label":"admin"
"To":0
"Value":0}]
"IP":""
"MBits":1
"Mode":""
"ReservedPorts":null}]}
"Services":[{"AddressMode":"auto"
"CanaryTags":null
"Checks":[{"AddressMode":""
"Args":null
"CheckRestart":null
"Command":""
"GRPCService":""
"GRPCUseTLS":false
"Header":null
"InitialStatus":""
"Interval":15000000000
"Method":""
"Name":"infoCheckFast"
"Path":"/infoCheck"
"PortLabel":"api"
"Protocol":""
"TLSSkipVerify":false
"TaskName":""
"Timeout":2000000000
"Type":"http"}
{"AddressMode":""
"Args":null
"CheckRestart":null
"Command":""
"GRPCService":""
"GRPCUseTLS":false
"Header":null
"InitialStatus":""
"Interval":150000000000
"Method":""
"Name":"infoCheckFull"
"Path":"/infoCheck?doChecks=true"
"PortLabel":"api"
"Protocol":""
"TLSSkipVerify":false
"TaskName":""
"Timeout":2000000000
"Type":"http"}]
"Connect":null
"Meta":null
"Name":"mm-api-content-curator"
"PortLabel":"api"
"Tags":["autodeploy"
"nodejs"
"withredis"
"api"
"traefik.enable=true"
"traefik.expose=int"]}
{"AddressMode":"auto"
"CanaryTags":null
"Checks":[{"AddressMode":""
"Args":null
"CheckRestart":null
"Command":""
"GRPCService":""
"GRPCUseTLS":false
"Header":null
"InitialStatus":""
"Interval":15000000000
"Method":""
"Name":"infoCheckFast"
"Path":"/infoCheck"
"PortLabel":"admin"
"Protocol":""
"TLSSkipVerify":false
"TaskName":""
"Timeout":2000000000
"Type":"http"}
{"AddressMode":""
"Args":null
"CheckRestart":null
"Command":""
"GRPCService":""
"GRPCUseTLS":false
"Header":null
"InitialStatus":""
"Interval":150000000000
"Method":""
"Name":"infoCheckFull"
"Path":"/infoCheck?doChecks=true"
"PortLabel":"admin"
"Protocol":""
"TLSSkipVerify":false
"TaskName":""
"Timeout":2000000000
"Type":"http"}]
"Connect":null
"Meta":null
"Name":"mm-api-content-curator-admin"
"PortLabel":"admin"
"Tags":["autodeploy"
"nodejs"
"withredis"
"admin"
"traefik.enable=true"
"traefik.expose=int"]}]
"ShutdownDelay":0
"Templates":[{"ChangeMode":"signal"
"ChangeSignal":"SIGHUP"
"DestPath":"local/env.yaml"
"EmbeddedTmpl":""
"Envvars":false
"LeftDelim":"{{"
"Perms":"0644"
"RightDelim":"}}"
"SourcePath":"local/env.yaml.tmpl"
"Splay":5000000000
"VaultGrace":15000000000}]
"User":""
"Vault":null
"VolumeMounts":null}]
"Update":{"AutoPromote":false
"AutoRevert":true
"Canary":0
"HealthCheck":"checks"
"HealthyDeadline":300000000000
"MaxParallel":1
"MinHealthyTime":10000000000
"ProgressDeadline":900000000000
"Stagger":30000000000}
"Volumes":null}]
"Type":"service"
"Update":{"AutoPromote":false
"AutoRevert":false
"Canary":0
"HealthCheck":""
"HealthyDeadline":0
"MaxParallel":1
"MinHealthyTime":0
"ProgressDeadline":0
"Stagger":30000000000}
"VaultToken":""
"Version":9}
"JobID":"mm-api-content-curator"
"Metrics":{"AllocationTime":448425
"ClassExhausted":null
"ClassFiltered":null
"CoalescedFailures":0
"ConstraintFiltered":{"distinct_property: ${meta.zone}=1 used by 1 allocs":2
"missing property \"${meta.zone}\"":1}
"DimensionExhausted":null
"NodesAvailable":{"azwe":6}
"NodesEvaluated":6
"NodesExhausted":0
"NodesFiltered":3
"QuotaExhausted":null
"ScoreMetaData":[{"NodeID":"84aaeedd-835c-7835-0f10-01f102c9774c"
"NormScore":0.953149249197434
"Scores":{"job-anti-affinity":0.0
"node-reschedule-penalty":0.0
"node-affinity":0.0
"binpack":0.953149249197434}}
{"NodeID":"1e4d22c8-08a1-eff3-20bf-d03922d94919"
"NormScore":0.28581240313364237
"Scores":{"binpack":0.28581240313364237
"job-anti-affinity":0.0
"node-reschedule-penalty":0.0
"node-affinity":0.0}}
{"NodeID":"e3caca7a-e93a-8d2f-f476-40254148622c"
"NormScore":-0.11498966055298881
"Scores":{"node-affinity":0.0
"binpack":0.7700206788940224
"job-anti-affinity":0.0
"node-reschedule-penalty":-1.0}}]
"Scores":null}
"ModifyIndex":33428
"ModifyTime":1584440663019873299
"Name":"mm-api-content-curator.mm-api-content-curator[0]"
"Namespace":"default"
"NodeID":"84aaeedd-835c-7835-0f10-01f102c9774c"
"NodeName":"nomadclient3"
"PreviousAllocation":"c355a7c0-98d8-0561-6de8-d3626dcc12d2"
"Resources":{"CPU":700
"Devices":null
"DiskMB":300
"IOPS":0
"MemoryMB":856
"Networks":[{"CIDR":""
"Device":"eth0"
"DynamicPorts":[{"Label":"api"
"To":0
"Value":31334}
{"Label":"admin"
"To":0
"Value":29991}
{"Label":"redis"
"To":0
"Value":20055}]
"IP":"172.21.39.7"
"MBits":11
"Mode":""
"ReservedPorts":null}]}
"SharedResources":{"CPU":0
"Devices":null
"DiskMB":300
"IOPS":0
"MemoryMB":0
"Networks":null}
"TaskGroup":"mm-api-content-curator"
"TaskResources":{"filebeat":{"CPU":100
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":300
"Networks":null}
"redis":{"CPU":100
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":300
"Networks":[{"CIDR":""
"Device":"eth0"
"DynamicPorts":[{"Label":"redis"
"To":0
"Value":20055}]
"IP":"172.21.39.7"
"MBits":10
"Mode":""
"ReservedPorts":null}]}
"mm-api-content-curator":{"CPU":500
"Devices":null
"DiskMB":0
"IOPS":0
"MemoryMB":256
"Networks":[{"CIDR":""
"Device":"eth0"
"DynamicPorts":[{"Label":"api"
"To":0
"Value":31334}
{"Label":"admin"
"To":0
"Value":29991}]
"IP":"172.21.39.7"
"MBits":1
"Mode":""
"ReservedPorts":null}]}}
"TaskStates":{"mm-api-content-curator":{"Events":[{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task received by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440530309264598
"Type":"Received"
"ValidationError":""
"VaultError":""}
{"Details":{"message":"Building Task Directory"}
"DiskLimit":0
"DisplayMessage":"Building Task Directory"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":"Building Task Directory"
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440538053180385
"Type":"Task Setup"
"ValidationError":""
"VaultError":""}
{"Details":{}
"DiskLimit":0
"DisplayMessage":"Client is downloading artifacts"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440538357955275
"Type":"Downloading Artifacts"
"ValidationError":""
"VaultError":""}
{"Details":{"image":"mondia.azurecr.io/mondia/mm-api-content-curator:3f7decb7c85"}
"DiskLimit":0
"DisplayMessage":"Downloading image"
"DownloadError":""
"DriverError":""
"DriverMessage":"Downloading image"
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440540252105561
"Type":"Driver"
"ValidationError":""
"VaultError":""}
{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task started by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440558002513716
"Type":"Started"
"ValidationError":""
"VaultError":""}]
"Failed":false
"FinishedAt":null
"LastRestart":null
"Restarts":0
"StartedAt":"2020-03-17T10:22:38.002519716Z"
"State":"running"}
"filebeat":{"Events":[{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task received by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440530308062090
"Type":"Received"
"ValidationError":""
"VaultError":""}
{"Details":{"message":"Building Task Directory"}
"DiskLimit":0
"DisplayMessage":"Building Task Directory"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":"Building Task Directory"
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440537986164091
"Type":"Task Setup"
"ValidationError":""
"VaultError":""}
{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task started by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440540217076868
"Type":"Started"
"ValidationError":""
"VaultError":""}]
"Failed":false
"FinishedAt":null
"LastRestart":null
"Restarts":0
"StartedAt":"2020-03-17T10:22:20.217085968Z"
"State":"running"}
"redis":{"Events":[{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task received by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440530308718494
"Type":"Received"
"ValidationError":""
"VaultError":""}
{"Details":{"message":"Building Task Directory"}
"DiskLimit":0
"DisplayMessage":"Building Task Directory"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":"Building Task Directory"
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440538030994155
"Type":"Task Setup"
"ValidationError":""
"VaultError":""}
{"Details":{"image":"redis:latest"}
"DiskLimit":0
"DisplayMessage":"Downloading image"
"DownloadError":""
"DriverError":""
"DriverMessage":"Downloading image"
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440538625487746
"Type":"Driver"
"ValidationError":""
"VaultError":""}
{"Details":{}
"DiskLimit":0
"DisplayMessage":"Task started by client"
"DownloadError":""
"DriverError":""
"DriverMessage":""
"ExitCode":0
"FailedSibling":""
"FailsTask":false
"GenericSource":""
"KillError":""
"KillReason":""
"KillTimeout":0
"Message":""
"RestartReason":""
"SetupError":""
"Signal":0
"StartDelay":0
"TaskSignal":""
"TaskSignalReason":""
"Time":1584440549717467351
"Type":"Started"
"ValidationError":""
"VaultError":""}]
"Failed":false
"FinishedAt":null
"LastRestart":null
"Restarts":0
"StartedAt":"2020-03-17T10:22:29.717477151Z"
"State":"running"}}}